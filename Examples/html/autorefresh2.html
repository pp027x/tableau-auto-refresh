
<!DOCTYPE html>

<html>

<title>API autorefresh</title>
<!-- Importing Tableau API -->
<script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.js"></script>

    
<body onload="initialize();">
       
<h1>Auto Refresh Dashboard Tableau</h1>    
    <div id="myViz">
        <iframe width="100%" height="635" frameborder="0"
  src="https://observablehq.com/embed/@d3/sortable-bar-chart?cell=viewof+order&cell=chart"></iframe>
    </div>


</body>
<script>

var viz;

function refreshView(){
    
	viz.refreshDataAsync();
    console.log("Refreshing ...");
}
    
    function initialize() {

        var placeholderDiv = document.getElementById("myViz");
        var url = "https://public.tableau.com/shared/DC4Q3GSGM?:display_count=n&:origin=viz_share_link";

        var options = {
            width: 900,
            height: 600,
            hideTabs: true,
            hideToolbar: true
            }
        viz = new tableau.Viz(placeholderDiv, url, options);
        }

    setInterval(refreshView,5000);

</script>


</html>
